"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[55924,74452],{78165:function(e,n,t){t.r(n),t.d(n,{Component:function(){return q}});var r=t(62540),o=t(63696),a=t(92779),i=t(57836),s=t(63703),l=t(28335),c=t(35117),u=t(60434),d=t(70564),h=t(10822),x=t(89348),f=t(69856),p=t(74156),y=t(57962),m=t(47891),A=t(2066),v=t(37631),g=t(31858),b=t(75487),j=t(13786),w=t(91520),S=t(62010),C=t(98756),k=t(37793),T=t(75720),N=t(9042),D=t(31720),I=t(82670),E=t(76745),F=t(85637),P=t(87404),B=t(5898),L=t(8566),U=function(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,s)}l((r=r.apply(e,n||[])).next())}))},z=function(e,n){var t,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(e){s=[6,e],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},M=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,o,a=t.call(e),i=[];try{for(;(void 0===n||n-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(t=a.return)&&t.call(a)}finally{if(o)throw o.error}}return i},O=function(e,n,t){if(t||2===arguments.length)for(var r,o=0,a=n.length;o<a;o++)!r&&o in n||(r||(r=Array.prototype.slice.call(n,0,o)),r[o]=n[o]);return e.concat(r||Array.prototype.slice.call(n))},R=function(e){if(0===e)return"0 Bytes";var n=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,n)).toFixed(2))," ").concat(["Bytes","KB","MB","GB","TB"][n])},W=function(e){return e?new Date("string"==typeof e?1e3*Number(e):1e3*e).toLocaleDateString():""},G=function(e){if(0===e)return"0 B/s";for(var n=["B/s","KB/s","MB/s","GB/s"],t=e,r=0;t>=1024&&r<n.length-1;)t/=1024,r++;return"".concat(t.toFixed(2)," ").concat(n[r])},J=function(e){if(e<=0||e>=864e4)return"Unknown";var n=Math.floor(e/3600),t=Math.floor(e%3600/60),r=Math.floor(e%60);return n>0?"".concat(n,"h ").concat(t,"m"):t>0?"".concat(t,"m ").concat(r,"s"):"".concat(r,"s")},q=function(){var e=(0,P.zy)(),n=(0,o.useRef)(null);if("/dashboard/TorrentSection"!==e.pathname&&"/dashboard/TorrentSection/"!==e.pathname)return console.log("TorrentSection not rendering - wrong path:",e.pathname),null;var t=M((0,o.useState)(""),2),q=t[0],K=t[1],_=M((0,o.useState)([]),2),H=_[0],Q=_[1],V=M((0,o.useState)([]),2),X=V[0],Y=V[1],Z=M((0,o.useState)(!1),2),$=Z[0],ee=Z[1],ne=M((0,o.useState)(!1),2),te=ne[0],re=ne[1],oe=M((0,o.useState)(0),2),ae=(oe[0],oe[1]),ie=M((0,o.useState)(null),2),se=ie[0],le=ie[1],ce=M((0,o.useState)([]),2),ue=ce[0],de=ce[1],he=M((0,o.useState)(!1),2),xe=he[0],fe=he[1],pe=M((0,o.useState)(null),2),ye=pe[0],me=pe[1],Ae=M((0,o.useState)([]),2),ve=Ae[0],ge=Ae[1],be=M((0,o.useState)(""),2),je=be[0],we=be[1],Se=M((0,o.useState)(!1),2),Ce=Se[0],ke=Se[1],Te=M((0,o.useState)(null),2),Ne=Te[0],De=Te[1],Ie=M((0,o.useState)(!1),2),Ee=Ie[0],Fe=Ie[1],Pe=(0,o.useCallback)((function(){return U(void 0,void 0,void 0,(function(){var e,n,t,r;return z(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,3,4]),ke(!0),e=window.ApiClient.getUrl("torrent/libraries"),[4,window.ApiClient.getJSON(e)];case 1:return n=o.sent(),ge(n||[]),(null==n?void 0:n.length)>0&&(null===(r=n[0].Paths)||void 0===r?void 0:r.length)>0&&we(n[0].Paths[0]),[3,4];case 2:return t=o.sent(),console.error("Failed to fetch libraries:",t),le("Failed to fetch libraries: ".concat(t instanceof Error?t.message:String(t))),[3,4];case 3:return ke(!1),[7];case 4:return[2]}}))}))}),[]),Be=(0,o.useCallback)((function(){return U(void 0,void 0,void 0,(function(){var e,n,t;return z(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,3,4]),fe(!0),me(null),e=window.ApiClient.getUrl("torrent/progress"),[4,window.ApiClient.getJSON(e)];case 1:return n=r.sent(),de(n||[]),[3,4];case 2:return t=r.sent(),console.error("Failed to fetch torrent progress:",t),me("Progress update failed: ".concat(t instanceof Error?t.message:String(t))),[3,4];case 3:return fe(!1),[7];case 4:return[2]}}))}))}),[]);(0,o.useEffect)((function(){return console.log("TorrentSection mounted"),Be(),Pe(),n.current=setInterval((function(){Be()}),3e3),function(){console.log("TorrentSection unmounting"),n.current&&clearInterval(n.current)}}),[Be,Pe]);var Le=(0,o.useCallback)((function(){return U(void 0,void 0,void 0,(function(){var e,n,t;return z(this,(function(r){switch(r.label){case 0:if(!q.trim())return[2];console.log("Searching for:",q),ee(!0),Q([]),le(null),L.Ay.show(),r.label=1;case 1:return r.trys.push([1,3,4,5]),e=window.ApiClient.getUrl("torrent/search",{q:q}),[4,window.ApiClient.getJSON(e)];case 2:return n=r.sent(),Q(n||[]),[3,5];case 3:return t=r.sent(),console.error("Search failed:",t),le("Search failed: ".concat(t instanceof Error?t.message:String(t))),[3,5];case 4:return ee(!1),L.Ay.hide(),[7];case 5:return[2]}}))}))}),[q]),Ue=(0,o.useCallback)((function(e){Y((function(n){return n.some((function(n){return n.Id===e.Id}))?n.filter((function(n){return n.Id!==e.Id})):O(O([],M(n),!1),[e],!1)}))}),[]),ze=(0,o.useCallback)((function(){return U(void 0,void 0,void 0,(function(){var e,n,t,r,o,a,i,s;return z(this,(function(l){switch(l.label){case 0:if(0===X.length)return[2];if(!je)return le("Please select a download location"),[2];console.log("Downloading selected items to:",je),re(!0),ae(0),le(null),L.Ay.show(),l.label=1;case 1:l.trys.push([1,10,11,12]),l.label=2;case 2:l.trys.push([2,7,8,9]),e=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(X),n=e.next(),l.label=3;case 3:return n.done?[3,6]:(t=n.value,r=window.ApiClient.getUrl("torrent/download"),[4,window.ApiClient.ajax({type:"POST",url:r,data:JSON.stringify({Info_hash:t.Info_hash,Name:t.Name,SavePath:je}),contentType:"application/json"})]);case 4:l.sent(),l.label=5;case 5:return n=e.next(),[3,3];case 6:return[3,9];case 7:return o=l.sent(),i={error:o},[3,9];case 8:try{n&&!n.done&&(s=e.return)&&s.call(e)}finally{if(i)throw i.error}return[7];case 9:return Be(),Y([]),[3,12];case 10:return a=l.sent(),console.error("Download failed:",a),le("Download failed: ".concat(a instanceof Error?a.message:String(a))),[3,12];case 11:return setTimeout((function(){re(!1),ae(0),L.Ay.hide()}),1e3),[7];case 12:return[2]}}))}))}),[X,je,Be]),Me=(0,o.useCallback)((function(e){return U(void 0,void 0,void 0,(function(){var n,t;return z(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n=window.ApiClient.getUrl("torrent/pause",{hash:e}),[4,window.ApiClient.ajax({type:"POST",url:n})];case 1:return r.sent(),Be(),[3,3];case 2:return t=r.sent(),console.error("Failed to pause torrent:",t),me("Failed to pause torrent: ".concat(t instanceof Error?t.message:String(t))),[3,3];case 3:return[2]}}))}))}),[Be]),Oe=(0,o.useCallback)((function(e){return U(void 0,void 0,void 0,(function(){var n,t;return z(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n=window.ApiClient.getUrl("torrent/resume",{hash:e}),[4,window.ApiClient.ajax({type:"POST",url:n})];case 1:return r.sent(),Be(),[3,3];case 2:return t=r.sent(),console.error("Failed to resume torrent:",t),me("Failed to resume torrent: ".concat(t instanceof Error?t.message:String(t))),[3,3];case 3:return[2]}}))}))}),[Be]),Re=(0,o.useCallback)((function(e){return U(void 0,void 0,void 0,(function(){var n,t;return z(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),n=window.ApiClient.getUrl("torrent/delete",{hash:e}),[4,window.ApiClient.ajax({type:"POST",url:n})];case 1:return r.sent(),Be(),[3,3];case 2:return t=r.sent(),console.error("Failed to delete torrent:",t),me("Failed to delete torrent: ".concat(t instanceof Error?t.message:String(t))),[3,3];case 3:return[2]}}))}))}),[Be]),We=(0,o.useCallback)((function(e){De(e),Fe(!0)}),[]),Ge=(0,o.useCallback)((function(){De(null),Fe(!1)}),[]),Je=(0,o.useCallback)((function(){Ne&&(Re(Ne),De(null),Fe(!1))}),[Re,Ne]);return(0,r.jsxs)("div",{style:{position:"absolute",top:0,left:"var(--sidebar-width, 240px)",right:0,bottom:0,backgroundColor:"var(--theme-background, #000)",zIndex:2,overflow:"auto",padding:"20px",pointerEvents:"auto"},children:[(0,r.jsx)("div",{className:"sectionTitleContainer flex align-items-center",children:(0,r.jsx)("h2",{className:"sectionTitle",children:B.Ay.translate("Torrent")})}),se&&(0,r.jsx)(m.A,{severity:"error",sx:{mb:2},children:se}),(0,r.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:B.Ay.translate("ActiveTorrents")}),ye&&(0,r.jsx)(m.A,{severity:"error",sx:{mb:2},children:ye}),(0,r.jsxs)(a.A,{sx:{mb:4},children:[xe&&0===ue.length&&(0,r.jsx)(h.A,{sx:{width:"100%",mb:2}}),0===ue.length&&!xe&&(0,r.jsx)(f.A,{elevation:1,sx:{p:2,textAlign:"center"},children:(0,r.jsx)(x.A,{children:"No active torrents"})}),(0,r.jsx)(y.Ay,{container:!0,spacing:2,children:ue.map((function(e){return(0,r.jsx)(y.Ay,{item:!0,xs:12,md:6,lg:4,children:(0,r.jsx)(j.A,{variant:"outlined",sx:{height:"100%",position:"relative",border:"1px solid rgba(255, 255, 255, 0.12)"},children:(0,r.jsxs)(w.A,{children:[(0,r.jsx)(x.A,{variant:"subtitle1",noWrap:!0,title:e.name,sx:{mb:1,fontWeight:"bold"},children:e.name}),(0,r.jsxs)(a.A,{sx:{display:"flex",alignItems:"center",mb:1},children:[(0,r.jsx)(a.A,{sx:{width:"100%",mr:1},children:(0,r.jsx)(h.A,{variant:"determinate",value:100*e.progress,sx:{height:8,borderRadius:1,"& .MuiLinearProgress-bar":{bgcolor:e.state.includes("DL")?"primary.main":"success.main"}}})}),(0,r.jsx)(a.A,{sx:{minWidth:45},children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:[(100*e.progress).toFixed(1),"%"]})})]}),(0,r.jsxs)(y.Ay,{container:!0,spacing:1,children:[(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Status: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:"downloading"===e.state?"Downloading":"uploading"===e.state?"Seeding":"pausedDL"===e.state?"Paused":"stoppedDL"===e.state?"Stopped":e.state})]})}),(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Size: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:R(e.size)})]})}),(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Down: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:G(e.dlspeed)})]})}),(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Up: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:G(e.upspeed)})]})}),(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["ETA: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:J(e.eta)})]})}),(0,r.jsx)(y.Ay,{item:!0,xs:6,children:(0,r.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Added: ",(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:W(e.added_on)})]})})]}),(0,r.jsxs)(a.A,{sx:{mt:2,display:"flex",justifyContent:"flex-end",gap:1},children:["pausedDL"===e.state||"stoppedDL"===e.state?(0,r.jsx)(b.A,{size:"small",color:"primary",onClick:function(){return Oe(e.hash)},title:"Resume",children:(0,r.jsx)(A.A,{})}):(0,r.jsx)(b.A,{size:"small",color:"primary",onClick:function(){return Me(e.hash)},title:"Pause",children:(0,r.jsx)(v.A,{})}),(0,r.jsx)(b.A,{size:"small",color:"error",onClick:function(){return We(e.hash)},title:"Delete",children:(0,r.jsx)(g.A,{})})]})]})})},e.hash)}))})]}),(0,r.jsx)(p.A,{sx:{my:3}}),(0,r.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:B.Ay.translate("SearchTorrents")}),(0,r.jsxs)(f.A,{elevation:2,sx:{p:2,mb:3,display:"flex",alignItems:"center",gap:2},children:[(0,r.jsx)(i.A,{label:B.Ay.translate("SearchTerm"),variant:"outlined",fullWidth:!0,value:q,onChange:function(e){return K(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&Le()},disabled:$||te}),(0,r.jsx)(s.A,{variant:"contained",onClick:Le,disabled:$||te||!q.trim(),children:B.Ay.translate("Search")})]}),(0,r.jsxs)(y.Ay,{container:!0,spacing:3,children:[(0,r.jsxs)(y.Ay,{item:!0,xs:12,md:7,children:[(0,r.jsxs)(x.A,{variant:"h6",gutterBottom:!0,children:[B.Ay.translate("SearchResults"),H.length>0&&" (".concat(H.length,")")]}),(0,r.jsxs)(f.A,{elevation:1,sx:{maxHeight:"50vh",overflow:"auto"},children:[$&&(0,r.jsx)(h.A,{sx:{width:"100%"}}),(0,r.jsxs)(l.A,{dense:!0,children:[0===H.length&&!$&&(0,r.jsx)(c.Ay,{children:(0,r.jsx)(u.A,{primary:B.Ay.translate("NoResultsEnterSearch")})}),H.map((function(e){return(0,r.jsx)(c.Ay,{secondaryAction:(0,r.jsx)(d.A,{edge:"end",onChange:function(){return Ue(e)},checked:X.some((function(n){return n.Id===e.Id})),disabled:te}),disablePadding:!0,children:(0,r.jsx)(a.A,{sx:{flexGrow:1,cursor:"pointer",p:1},onClick:function(){return Ue(e)},children:(0,r.jsx)(u.A,{primary:e.Name,secondary:(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(x.A,{component:"span",variant:"body2",color:"text.primary",children:"".concat(Number(e.Seeders).toLocaleString()," seeders • ").concat(Number(e.Leechers).toLocaleString()," leechers")}),(0,r.jsx)("br",{}),(0,r.jsx)(x.A,{component:"span",variant:"body2",children:"".concat(R(Number(e.Size))," • ").concat(W(e.Added))}),e.Username&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),(0,r.jsx)(x.A,{component:"span",variant:"body2",children:"Uploader: ".concat(e.Username)})]})]})})})},e.Id)}))]})]})]}),(0,r.jsxs)(y.Ay,{item:!0,xs:12,md:5,children:[(0,r.jsxs)(x.A,{variant:"h6",gutterBottom:!0,children:[B.Ay.translate("SelectedForDownload"),X.length>0&&" (".concat(X.length,")")]}),(0,r.jsx)(f.A,{elevation:1,sx:{maxHeight:"50vh",overflow:"auto"},children:(0,r.jsxs)(l.A,{dense:!0,children:[0===X.length&&(0,r.jsx)(c.Ay,{children:(0,r.jsx)(u.A,{primary:B.Ay.translate("NoItemsSelected")})}),X.map((function(e){return(0,r.jsxs)(c.Ay,{children:[(0,r.jsx)(u.A,{primary:e.Name,secondary:"".concat(R(Number(e.Size)))}),(0,r.jsx)(s.A,{size:"small",color:"error",onClick:function(){return Ue(e)},children:B.Ay.translate("Remove")})]},e.Id)}))]})})]})]}),(0,r.jsx)(p.A,{sx:{my:3}}),(0,r.jsxs)(a.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[(0,r.jsx)(a.A,{sx:{width:"100%",maxWidth:500,mb:2},children:(0,r.jsxs)(D.A,{fullWidth:!0,variant:"outlined",children:[(0,r.jsx)(I.A,{id:"download-location-label",children:"Download Location"}),(0,r.jsx)(E.A,{labelId:"download-location-label",value:je,onChange:function(e){return we(e.target.value)},label:"Download Location",disabled:te||Ce||0===ve.length,children:ve.flatMap((function(e){return e.Paths.map((function(n){return(0,r.jsx)(F.A,{value:n,children:"".concat(e.Name,": ").concat(n)},"".concat(e.Name,"-").concat(n))}))}))})]})}),(0,r.jsx)(s.A,{variant:"contained",color:"primary",onClick:ze,disabled:0===X.length||te||$||!je,size:"large",children:B.Ay.translate("DownloadSelected")}),te&&(0,r.jsxs)(a.A,{sx:{width:"50%",mt:1},children:[(0,r.jsx)(h.A,{variant:"indeterminate"}),(0,r.jsx)(x.A,{variant:"body2",color:"text.secondary",align:"center",sx:{mt:.5},children:"Adding torrents..."})]})]}),(0,r.jsxs)(S.A,{open:Ee,onClose:Ge,children:[(0,r.jsx)(N.A,{children:"Delete Torrent"}),(0,r.jsx)(k.A,{children:(0,r.jsx)(T.A,{children:"Are you sure you want to delete this torrent? This action cannot be undone."})}),(0,r.jsxs)(C.A,{children:[(0,r.jsx)(s.A,{onClick:Ge,children:"Cancel"}),(0,r.jsx)(s.A,{onClick:Je,color:"error",autoFocus:!0,children:"Delete"})]})]})]})};q.displayName="TorrentSectionPage"},95401:function(e,n,t){t.r(n),t.d(n,{default:function(){return s}}),t(5898);var r=t(8566),o=(t(10353),t(89100),t(63696)),a=t(78325),i=t(78165);function s(e){e.addEventListener("viewshow",(function(){r.Ay.show();var n=e.querySelector(".mainContent");a.render(o.createElement(i.Component),n),r.Ay.hide()})),e.addEventListener("viewhide",(function(){var n=e.querySelector(".mainContent");n&&a.unmountComponentAtNode(n)}))}}}]);