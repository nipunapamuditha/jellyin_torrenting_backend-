"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[90221],{1217:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}}),n(44962),n(78557),n(90076),n(83994),n(82367);var i,a=n(8566),r=(n(14382),n(84734),n(86584),n(22696)),o=n.n(r),d=(n(63855),n(5898)),l=n(89100),s=n(83375);function c(e,t,n){var i=u(e),a={id:e.Id,text:i,state:{opened:e.IsFolder&&"open"==t,selected:n},li_attr:{serveritemtype:e.Type,collectiontype:e.CollectionType}};return e.IsFolder?(a.children=[{text:"Loading...",icon:!1}],a.icon=!1):a.icon=!1,a.state.opened&&(a.li_attr.loadedFromServer=!0),n&&(y=e.Id),a}function u(e){var t=e.Name;e.Number&&(t=e.Number+" - "+t),null!=e.IndexNumber&&"Season"!=e.Type&&(t=e.IndexNumber+" - "+t);var n="<div class='editorNode'>";return e.IsFolder?n+='<span class="material-icons metadataSidebarIcon folder" aria-hidden="true"></span>':"Video"===e.MediaType?n+='<span class="material-icons metadataSidebarIcon movie" aria-hidden="true"></span>':"Audio"===e.MediaType?n+='<span class="material-icons metadataSidebarIcon audiotrack" aria-hidden="true"></span>':"TvChannel"===e.Type?n+='<span class="material-icons metadataSidebarIcon live_tv" aria-hidden="true"></span>':"Photo"===e.MediaType?n+='<span class="material-icons metadataSidebarIcon photo" aria-hidden="true"></span>':"Book"===e.MediaType&&(n+='<span class="material-icons metadataSidebarIcon book" aria-hidden="true"></span>'),e.LockData&&(n+='<span class="material-icons metadataSidebarIcon lock" aria-hidden="true"></span>'),(n+=o()(t))+"</div>"}function f(e,t,i,a){Promise.all([Promise.all([n.e(87348),n.e(51850)]).then(n.t.bind(n,83392,23)),Promise.all([n.e(87348),n.e(79245)]).then(n.bind(n,44204))]).then((function(){!function(e,t,n,i){I=[],y=null,$.jstree.destroy(),$(".libraryTree",e).jstree({plugins:["wholerow"],core:{check_callback:!0,data:function(e,t){!function(e,t,n,i,a,r,o){var s=n.id;if("#"!=s)if("livetv"!=s)if("MediaFolders"!=s){var u={ParentId:s,Fields:"Settings",IsVirtualUnaired:!1,IsMissing:!1,EnableTotalRecordCount:!1,EnableImages:!1,EnableUserData:!1},f=n.li_attr.itemtype;"Season"!=f&&"Series"!=f&&(u.SortBy="SortName"),ApiClient.getItems(l.default.getCurrentUserId(),u).then((function(e){var n=e.Items.map((function(e){return c(e,-1==i.indexOf(e.Id)?"closed":"open",e.Id==a)}));o.call(t,n);for(var r=0,d=n.length;r<d;r++)n[r].state.opened&&I.push(n[r].id)}))}else!function(e,t,n,i){ApiClient.getJSON(ApiClient.getUrl("Library/MediaFolders")).then((function(e){var a=e.Items.map((function(e){return c(e,-1==n.indexOf(e.Id)?"closed":"open",!1)}));i.call(t,a);for(var r=0,o=a.length;r<o;r++)a[r].state.opened&&I.push(a[r].id)}))}(0,t,i,o);else!function(e,t,n){ApiClient.getLiveTvChannels({ServiceName:e,AddCurrentProgram:!1}).then((function(e){var i=e.Items.map((function(e){return c(e,-1==t.indexOf(e.Id)?"closed":"open",!1)}));n(i)}))}(s,i,o);else!function(e,t,n){ApiClient.getLiveTvChannels({limit:0}).then((function(e){var i=[];i.push({id:"MediaFolders",text:d.Ay.translate("HeaderMediaFolders"),state:{opened:!0},li_attr:{itemtype:"mediafolders",loadedFromServer:!0},icon:!1}),e.TotalRecordCount&&i.push({id:"livetv",text:d.Ay.translate("LiveTV"),state:{opened:!1},li_attr:{itemtype:"livetv"},children:[{text:"Loading...",icon:!1}],icon:!1}),n.call(t,i),I.push("MediaFolders")}))}(0,t,o)}(0,this,e,n,i,0,t)},themes:{variant:"large"}}}).off("select_node.jstree",p).on("select_node.jstree",p).off("open_node.jstree",m).on("open_node.jstree",m).off("load_node.jstree",m).on("load_node.jstree",m)}(e,0,i,a)}))}function p(e,t){var n=t.node,i={id:n.id,itemType:n.li_attr.itemtype,serverItemType:n.li_attr.serveritemtype,collectionType:n.li_attr.collectiontype};"livetv"!=i.itemType&&"mediafolders"!=i.itemType?(this.dispatchEvent(new CustomEvent("itemclicked",{detail:i,bubbles:!0,cancelable:!1})),document.querySelector(".editPageSidebar").classList.add("editPageSidebar-withcontent")):document.querySelector(".editPageSidebar").classList.remove("editPageSidebar-withcontent")}function m(e,t){var n=$(this).parents(".page")[0],i=t.node;i.children&&function(e,t){for(var n=t.children,i=function(){var t=n[a];-1!=I.indexOf(t)&&(I=I.filter((function(e){return e!=t})),$.jstree.reference(".libraryTree",e).load_node(t,h))},a=0,r=n.length;a<r;a++)i()}(n,i),i.li_attr&&"#"!=i.id&&!i.li_attr.loadedFromServer&&(i.li_attr.loadedFromServer=!0,$.jstree.reference(".libraryTree",n).load_node(i.id,h))}function h(e){y&&e.children&&-1!=e.children.indexOf(y)&&setTimeout((function(){var e;(e=$("#"+y)[0])&&e.scrollIntoView()}),500)}function v(e){i=e}function b(){return i||(0,s.E)("id")}var y,I=[];function g(e,t){a.Ay.show(),t?Promise.all([n.e(45642),n.e(26855),n.e(63741)]).then(n.bind(n,26855)).then((function(n){n.default.embed(e.querySelector(".editPageInnerContent"),t,ApiClient.serverInfo().Id)})):(e.querySelector(".editPageInnerContent").innerHTML="",a.Ay.hide())}function S(e){e.addEventListener("viewshow",(function(){g(this,b())})),v(null),e.querySelector(".libraryTree").addEventListener("itemclicked",(function(t){var n=t.detail;n.id!=b()&&(v(n.id),g(e,n.id))}))}$(document).on("itemsaved",".metadataEditorPage",(function(e,t){!function(e,t){var n=$("#"+t.Id+">a",e)[0];if(null!=n&&($(".editorNode",n).remove(),$(n).append(u(t)),t.IsFolder)){var i=jQuery.jstree._reference(".libraryTree"),a=i._get_node(null,!1);i.refresh(a)}}(this,t)})).on("pagebeforeshow",".metadataEditorPage",(function(){n.e(71830).then(n.bind(n,71830))})).on("pagebeforeshow",".metadataEditorPage",(function(){var e=this;l.default.getCurrentUser().then((function(t){var n=b();n?ApiClient.getAncestorItems(n,t.Id).then((function(t){var i=t.map((function(e){return e.Id}));f(e,0,i,n)})):f(e,0,[])}))})).on("pagebeforehide",".metadataEditorPage",(function(){$(".libraryTree",this).off("select_node.jstree",p).off("open_node.jstree",m).off("load_node.jstree",m)}))}}]);