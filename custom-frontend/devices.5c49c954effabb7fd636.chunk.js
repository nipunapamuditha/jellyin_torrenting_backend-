"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[23920],{7397:function(e,t,n){var r=n(30177),o=n(41906);t.A=function(e){var t=e.cell,n=(0,o.Y)().dateFnsLocale;return(0,r.A)(t.getValue(),"Pp",{locale:n})}},32203:function(e,t,n){n.d(t,{Bq:function(){return l},Jd:function(){return c},yq:function(){return a}});var r=n(65369),o=n(11444),i="assets/img/devices/";function a(e){var t;switch(e.AppName||e.Client){case"Samsung Smart TV":return i+"samsungtv.svg";case"Xbox One":return i+"xbox.svg";case"Sony PS4":return i+"playstation.svg";case"Kodi":case"Kodi JellyCon":return i+"kodi.svg";case"Jellyfin Android":case"AndroidTV":case"Android TV":return i+"android.svg";case"Jellyfin Mobile (iOS)":case"Jellyfin Mobile (iPadOS)":case"Jellyfin iOS":case"Jellyfin iPadOS":case"Jellyfin tvOS":case"Swiftfin iPadOS":case"Swiftfin iOS":case"Swiftfin tvOS":case"Infuse":case"Infuse-Direct":case"Infuse-Library":return i+"apple.svg";case"Home Assistant":return i+"home-assistant.svg";case"Jellyfin for WebOS":case"LG Smart TV":return i+"webos.svg";case"Jellyfin Roku":return i+"roku.svg";case"Finamp":return i+"finamp.svg";case"Jellyfin Web":return function(e){switch(e){case"Opera":case"Opera TV":case"Opera Android":return i+"opera.svg";case"Chrome":case"Chrome Android":return i+"chrome.svg";case"Firefox":case"Firefox Android":return i+"firefox.svg";case"Safari":case"Safari iPad":case"Safari iPhone":return i+"safari.svg";case"Edge Chromium":case"Edge Chromium Android":case"Edge Chromium iPad":case"Edge Chromium iPhone":return i+"edgechromium.svg";case"Edge":return i+"edge.svg";case"Internet Explorer":return i+"msie.svg";default:return i+"html5.svg"}}(e.Name||e.DeviceName);default:if(null===(t=e.Capabilities)||void 0===t?void 0:t.IconUrl)try{return new URL(e.Capabilities.IconUrl).toString()}catch(t){console.error("[getDeviceIcon] device capabilities has invalid IconUrl",e,t)}return i+"other.svg"}}function c(e){switch(e){case r.X.Movies:return"movie";case r.X.Music:return"music_note";case r.X.Homevideos:case r.X.Photos:return"photo";case r.X.Livetv:return"live_tv";case r.X.Tvshows:return"tv";case r.X.Trailers:return"theaters";case r.X.Musicvideos:return"music_video";case r.X.Books:return"book";case r.X.Boxsets:return"video_library";case r.X.Playlists:return"queue";case"channels":return"videocam";case void 0:return"quiz";default:return"folder"}}function l(e,t){switch(e){case o.D.MusicAlbum:return"album";case o.D.MusicArtist:case o.D.Person:return"person";case o.D.Audio:return"audiotrack";case o.D.Movie:return"movie";case o.D.Episode:case o.D.Series:return"tv";case o.D.Program:return"live_tv";case o.D.Book:return"book";case o.D.Folder:return"folder";case o.D.BoxSet:return"video_library";case o.D.Playlist:return"queue";case o.D.Photo:return"photo";case o.D.PhotoAlbum:return"photo_album";default:return t}}t.Ay={getDeviceIcon:a,getLibraryIcon:c,getItemTypeIcon:l}},36589:function(e,t,n){n.d(t,{O:function(){return u}});var r=n(62540),o=n(92779),i=n(70140),a=n(89348),c=n(51602),l=(n(63696),n(65242)),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},u={enableColumnPinning:!0,enableColumnResizing:!0,enableStickyFooter:!0,enableStickyHeader:!0,muiTableContainerProps:{sx:{maxHeight:"calc(100% - 7rem)"}}};t.A=function(e){var t=e.title,n=e.subtitle,u=e.table,f=e.children,d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["title","subtitle","table","children"]);return(0,r.jsxs)(l.A,s({title:t},d,{children:[(0,r.jsxs)(o.A,{className:"content-primary",sx:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,r.jsxs)(i.A,{spacing:2,sx:{marginBottom:1},children:[(0,r.jsx)(a.A,{variant:"h2",children:t}),n&&(0,r.jsx)(a.A,{children:n})]}),(0,r.jsx)(c.zp,{table:u})]}),f]}))}},41906:function(e,t,n){n.d(t,{Y:function(){return f}});var r=n(62864),o=n(63696),i=n(5898),a=n(93721),c=n(28626),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},u=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a};function f(){var e=this,t=(0,c.Q)(),n=t.dateTimeLocale,f=t.language,d=u((0,o.useState)(r.A),2),p=d[0],v=d[1],y=(0,o.useMemo)((function(){return(0,i.Tl)(f||(0,i.i5)())}),[f]),h=(0,o.useMemo)((function(){return n?(0,i.Tl)(n):y}),[n,y]);return(0,o.useEffect)((function(){l(e,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,a.Fq)((0,a.QC)(h))];case 1:return e=n.sent(),v(e),[3,3];case 2:return t=n.sent(),console.warn("[useLocale] failed to fetch dateFns locale",t),[3,3];case 3:return[2]}}))}))}),[h]),{locale:y,dateTimeLocale:h,dateFnsLocale:p}}},56080:function(e,t,n){n.r(t),n.d(t,{Component:function(){return k}});var r=n(62540),o=n(31858),i=n(17997),a=n(92779),c=n(63703),l=n(75487),s=n(72073),u=n(34401),f=n(51602),d=n(63696),p=n(7397),v=n(36589),y=n(57227),h=n(81098),m=n(38596),b=n(69410),g=n(31297),x=n(61586),A="Devices",w=function(e){var t=(0,b.gf)().api;return(0,x.I)({queryKey:[A,e],queryFn:function(n){var r=n.signal;return function(e,t,n){return r=void 0,o=void 0,a=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(r){switch(r.label){case 0:return[4,(0,h.g)(e).getDevices(t,{signal:null==n?void 0:n.signal})];case 1:return[2,r.sent().data]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function c(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(n,c)}l((a=a.apply(r,o||[])).next())}));var r,o,i,a}(t,e,{signal:r})},enabled:!!t})},O=n(32203),j=function(e){var t=e.row,n=e.renderedCellValue;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{alt:t.original.AppName||void 0,src:(0,O.yq)(t.original),style:{display:"inline-block",maxWidth:"1.5em",maxHeight:"1.5em",marginRight:"1rem"}}),n]})},C=n(57807),S=n(92058),I=n(5898),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},D.apply(this,arguments)},P=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},k=function(){var e=(0,b.gf)().api,t=w({}),n=t.data,x=t.isLoading,O=t.isRefetching,k=(0,d.useMemo)((function(){return(null==n?void 0:n.Items)||[]}),[n]),E=(0,S.y)(),L=E.usersById,N=E.names,T=E.isLoading,B=P((0,d.useState)(!1),2),F=B[0],q=B[1],M=P((0,d.useState)(!1),2),X=M[0],J=M[1],R=P((0,d.useState)(),2),U=R[0],V=R[1],z=function(){var e=(0,b.gf)().api;return(0,m.n)({mutationFn:function(t){return(0,h.g)(e).deleteDevice(t)},onSuccess:function(){g.q.invalidateQueries({queryKey:[A]})}})}(),H=function(){var e=(0,b.gf)().api;return(0,m.n)({mutationFn:function(t){return(0,h.g)(e).updateDeviceOptions(t)},onSuccess:function(){g.q.invalidateQueries({queryKey:[A]})}})}(),_=x||T,K=(0,d.useCallback)((function(e){return function(){e&&(V(e),q(!0))}}),[]),G=(0,d.useCallback)((function(){V(void 0),q(!1)}),[]),Q=(0,d.useCallback)((function(){U&&z.mutate({id:U},{onSettled:G})}),[z,G,U]),W=(0,d.useCallback)((function(){J(!0)}),[]),Y=(0,d.useCallback)((function(){J(!1)}),[]),Z=(0,d.useCallback)((function(){k&&Promise.all(k.map((function(t){return e&&t.Id&&e.deviceInfo.id===t.Id?z.mutateAsync({id:t.Id}):Promise.resolve()}))).catch((function(e){console.error("[DevicesPage] failed deleting all devices",e)})).finally((function(){Y()}))}),[e,z,k,Y]),$=function(e){return function(t){var n=t.renderedCellValue,o=t.row;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y.A,{user:o.original.LastUserId&&e[o.original.LastUserId]||void 0,sx:{mr:"1rem"}}),n]})}}(L),ee=(0,d.useMemo)((function(){return[{id:"DateLastActivity",accessorFn:function(e){return e.DateLastActivity?(0,u.A)(e.DateLastActivity):void 0},header:I.Ay.translate("LastActive"),size:160,Cell:p.A,filterVariant:"datetime-range",enableEditing:!1},{id:"Name",accessorFn:function(e){return e.CustomName||e.Name},header:I.Ay.translate("LabelDevice"),size:200,Cell:j},{id:"App",accessorFn:function(e){return[e.AppName,e.AppVersion].filter((function(e){return!!e})).join(" ")},header:I.Ay.translate("LabelAppName"),size:200,enableEditing:!1},{accessorKey:"LastUserName",header:I.Ay.translate("LabelUser"),size:120,enableEditing:!1,Cell:$,filterVariant:"multi-select",filterSelectOptions:N}]}),[$,N]),te=(0,f.Up)(D(D({},v.O),{columns:ee,data:k,initialState:{density:"compact",pagination:{pageIndex:0,pageSize:25}},state:{isLoading:_},autoResetPageIndex:!O,enableEditing:!0,onEditingRowSave:function(e){var t,n=e.table,r=e.row,o=null===(t=e.values.Name)||void 0===t?void 0:t.trim(),i=r.original.CustomName?o!==r.original.CustomName:o!==r.original.Name;r.original.Id&&i&&H.mutate({id:r.original.Id,deviceOptionsDto:{CustomName:o||void 0}}),n.setEditingRow(null)},enableRowActions:!0,positionActionsColumn:"last",displayColumnDefOptions:{"mrt-row-actions":{header:""}},renderRowActions:function(t){var n=t.row,c=t.table,u=e&&n.original.Id&&e.deviceInfo.id===n.original.Id;return(0,r.jsxs)(a.A,{sx:{display:"flex",gap:1},children:[(0,r.jsx)(s.A,{title:I.Ay.translate("Edit"),children:(0,r.jsx)(l.A,{onClick:function(){return c.setEditingRow(n)},children:(0,r.jsx)(i.A,{})})}),u?(0,r.jsx)(l.A,{color:"error",disabled:!0,children:(0,r.jsx)(o.A,{})}):(0,r.jsx)(s.A,{title:I.Ay.translate("Delete"),children:(0,r.jsx)(l.A,{color:"error",onClick:K(n.original.Id),children:(0,r.jsx)(o.A,{})})})]})},renderTopToolbarCustomActions:function(){return(0,r.jsx)(c.A,{color:"error",startIcon:(0,r.jsx)(o.A,{}),onClick:W,children:I.Ay.translate("DeleteAll")})}}));return(0,r.jsxs)(v.A,{id:"devicesPage",title:I.Ay.translate("HeaderDevices"),className:"mainAnimatedPage type-interior",table:te,children:[(0,r.jsx)(C.A,{open:F,title:I.Ay.translate("HeaderDeleteDevice"),text:I.Ay.translate("DeleteDeviceConfirmation"),onCancel:G,onConfirm:Q,confirmButtonColor:"error",confirmButtonText:I.Ay.translate("Delete")}),(0,r.jsx)(C.A,{open:X,title:I.Ay.translate("HeaderDeleteDevices"),text:I.Ay.translate("DeleteDevicesConfirmation"),onCancel:Y,onConfirm:Z,confirmButtonColor:"error",confirmButtonText:I.Ay.translate("Delete")})]})};k.displayName="DevicesPage"},57227:function(e,t,n){var r=n(62540),o=n(75487),i=(n(63696),n(9055)),a=n(81965),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)};t.A=function(e){var t=e.user,n=e.sx;return(null==t?void 0:t.Id)?(0,r.jsx)(o.A,{size:"large",color:"inherit",sx:c({padding:0},n),title:t.Name||void 0,component:i.N_,to:"/dashboard/users/profile?userId=".concat(t.Id),children:(0,r.jsx)(a.A,{user:t})}):void 0}},57807:function(e,t,n){var r=n(62540),o=n(63703),i=n(62010),a=n(98756),c=n(37793),l=n(75720),s=n(9042),u=(n(63696),n(5898)),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)};t.A=function(e){var t=e.confirmButtonColor,n=void 0===t?"primary":t,d=e.confirmButtonText,p=e.title,v=e.text,y=e.onCancel,h=e.onConfirm,m=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["confirmButtonColor","confirmButtonText","title","text","onCancel","onConfirm"]);return(0,r.jsxs)(i.A,f({onClose:y},m,{children:[(0,r.jsx)(s.A,{children:p}),(0,r.jsx)(c.A,{children:(0,r.jsx)(l.A,{children:v})}),(0,r.jsxs)(a.A,{children:[(0,r.jsx)(o.A,{variant:"text",onClick:y,children:u.Ay.translate("ButtonCancel")}),(0,r.jsx)(o.A,{color:n,onClick:h,children:d||u.Ay.translate("ButtonOk")})]})]}))}},92058:function(e,t,n){n.d(t,{k:function(){return c},y:function(){return l}});var r=n(18879),o=n(61586),i=n(69410),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)},c=function(e){var t=(0,i.gf)().api;return(0,o.I)({queryKey:["Users"],queryFn:function(n){var o=n.signal;return function(e,t,n){return o=void 0,i=void 0,c=function(){return function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}}(this,(function(o){switch(o.label){case 0:return[4,(0,r.q)(e).getUsers(t,{signal:null==n?void 0:n.signal})];case 1:return[2,o.sent().data]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{l(c.next(e))}catch(e){t(e)}}function r(e){try{l(c.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(n,r)}l((c=c.apply(o,i||[])).next())}));var o,i,a,c}(t,e,{signal:o})},enabled:!!t})},l=function(){var e=c(),t=e.data,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["data"]),r={},o=[];return t&&t.forEach((function(e){var t=e.Id;t&&(r[t]=e),e.Name&&o.push(e.Name)})),a({users:t,usersById:r,names:o},n)}}}]);