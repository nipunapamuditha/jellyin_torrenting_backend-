"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[10878],{21475:function(e,n,t){t.r(n),t.d(n,{Component:function(){return q},action:function(){return B},loader:function(){return R}});var a=t(62540),r=t(94732),i=t(64788),o=t(31858),s=t(38008),l=t(47891),c=t(92779),u=t(63703),d=t(96441),f=t(70140),h=t(67854),p=t(57836),g=t(89348),m=t(63696),y=t(87404),v=t(9055),b=t(44419),x=t(84849),A=t(69664),C=t(65242),j=t(51371),S=t(69410),w=t(5898),k=t(59774),D=t(31297),L=function(){return L=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},L.apply(this,arguments)},P=function(e,n,t,a){return new(t||(t=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(o,s)}l((a=a.apply(e,n||[])).next())}))},I=function(e,n){var t,a,r,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(l){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(i=0)),i;)try{if(t=1,a&&(r=2&s[0]?a.return:s[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,s[1])).done)return r;switch(a=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],a=0}finally{t=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},E=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var a,r,i=t.call(e),o=[];try{for(;(void 0===n||n-- >0)&&!(a=i.next()).done;)o.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(r)throw r.error}}return o},N="branding",O={CustomCss:"CustomCss",LoginDisclaimer:"LoginDisclaimer",SplashscreenEnabled:"SplashscreenEnabled"},B=function(e){return P(void 0,[e],void 0,(function(e){var n,t,a,i,o,s,l,c=e.request;return I(this,(function(e){switch(e.label){case 0:if(!(n=k.tF.getCurrentApi()))throw new Error("No Api instance available");return[4,c.formData()];case 1:return t=e.sent(),a=Object.fromEntries(t),i={CustomCss:null===(o=a.CustomCss)||void 0===o?void 0:o.toString(),LoginDisclaimer:null===(s=a.LoginDisclaimer)||void 0===s?void 0:s.toString(),SplashscreenEnabled:"on"===(null===(l=a.SplashscreenEnabled)||void 0===l?void 0:l.toString())},[4,(0,r.T)(n).updateNamedConfiguration({key:N,body:JSON.stringify(i)})];case 2:return e.sent(),D.q.invalidateQueries({queryKey:[b.t5]}),[2,{isSaved:!0}]}}))}))},R=function(){return D.q.ensureQueryData((0,b.iz)(k.tF.getCurrentApi()))},q=function(){var e,n=(0,S.gf)().api,t=(0,y.cq)(),k=(0,y.mP)(),B="submitting"===t.state,R=(0,b.l9)(),q=R.data,F=R.isPending,T=E((0,m.useState)(q||{}),2),U=T[0],H=T[1],z=E((0,m.useState)(),2),Q=z[0],J=z[1],K=E((0,m.useState)(null!==(e=U.SplashscreenEnabled)&&void 0!==e&&e),2),W=K[0],G=K[1],V=E((0,m.useState)(),2),M=V[0],X=V[1];(0,m.useEffect)((function(){n&&!B&&X(n.getUri(j.u,{t:Date.now()}))}),[n,B]);var Y=(0,m.useCallback)((function(){J(void 0),n&&(0,i.C)(n).deleteCustomSplashscreen().then((function(){X(n.getUri(j.u,{t:Date.now()}))})).catch((function(e){console.error("[BrandingPage] error deleting image",e),J("ImageDeleteFailed")}))}),[n]),Z=(0,m.useCallback)((function(e){J(void 0);var t=e.target.files;if(!n||!t)return!1;var a=t[0],r=new FileReader;r.onerror=function(e){console.error("[BrandingPage] error reading file",e),J("ImageUploadFailed")},r.onabort=function(e){console.warn("[BrandingPage] aborted reading file",e),J("ImageUploadCancelled")},r.onload=function(){var e;if(r.result){var t=r.result,o=t.split(",")[1];(0,i.C)(n).uploadCustomSplashscreen({body:o},{headers:(e={},e["Content-Type"]=a.type,e)}).then((function(){X(t)})).catch((function(e){console.error("[BrandingPage] error uploading splashscreen",e),J("ImageUploadFailed")}))}},r.readAsDataURL(a)}),[n]),$=(0,m.useCallback)((function(e,t){return P(void 0,void 0,void 0,(function(){return I(this,(function(e){switch(e.label){case 0:return G(t),[4,(0,r.T)(n).updateNamedConfiguration({key:N,body:JSON.stringify(L(L({},q),{SplashscreenEnabled:t}))})];case 1:return e.sent(),D.q.invalidateQueries({queryKey:[b.t5]}),[2]}}))}))}),[n,q]),_=(0,m.useCallback)((function(e){var n;Object.keys(O).includes(e.target.name)&&H(L(L({},U),((n={})[e.target.name]=e.target.value,n)))}),[U]),ee=(0,m.useCallback)((function(){J(void 0)}),[]);return F?(0,a.jsx)(x.A,{}):(0,a.jsx)(C.A,{id:"brandingPage",title:w.Ay.translate("HeaderBranding"),className:"mainAnimatedPage type-interior",children:(0,a.jsx)(c.A,{className:"content-primary",children:(0,a.jsx)(v.lV,{method:"POST",onSubmit:ee,children:(0,a.jsxs)(f.A,{spacing:3,children:[(0,a.jsx)(g.A,{variant:"h1",children:w.Ay.translate("HeaderBranding")}),!B&&(null==k?void 0:k.isSaved)&&(0,a.jsx)(l.A,{severity:"success",children:w.Ay.translate("SettingsSaved")}),Q&&(0,a.jsx)(l.A,{severity:"error",children:w.Ay.translate(Q)}),(0,a.jsxs)(f.A,{direction:{xs:"column",sm:"row"},spacing:3,children:[(0,a.jsx)(c.A,{sx:{flex:"1 1 0"},children:(0,a.jsx)(A.A,{isLoading:!1,url:W?M:void 0})}),(0,a.jsxs)(f.A,{spacing:{xs:3,sm:2},sx:{flex:"1 1 0"},children:[(0,a.jsx)(d.A,{control:(0,a.jsx)(h.A,{name:O.SplashscreenEnabled,checked:W,onChange:$}),label:w.Ay.translate("EnableSplashScreen")}),(0,a.jsx)(g.A,{variant:"body2",children:w.Ay.translate("CustomSplashScreenSize")}),(0,a.jsxs)(u.A,{component:"label",variant:"outlined",startIcon:(0,a.jsx)(s.A,{}),disabled:!W,children:[(0,a.jsx)("input",{type:"file",accept:"image/*",hidden:!0,onChange:Z}),w.Ay.translate("UploadCustomImage")]}),(0,a.jsx)(u.A,{variant:"outlined",color:"error",startIcon:(0,a.jsx)(o.A,{}),disabled:!W,onClick:Y,children:w.Ay.translate("DeleteCustomImage")})]})]}),(0,a.jsx)(p.A,{fullWidth:!0,multiline:!0,minRows:5,maxRows:5,name:O.LoginDisclaimer,label:w.Ay.translate("LabelLoginDisclaimer"),helperText:w.Ay.translate("LabelLoginDisclaimerHelp"),value:null==U?void 0:U.LoginDisclaimer,onChange:_,slotProps:{input:{className:"textarea-mono"}}}),(0,a.jsx)(p.A,{fullWidth:!0,multiline:!0,minRows:5,maxRows:20,name:O.CustomCss,label:w.Ay.translate("LabelCustomCss"),helperText:w.Ay.translate("LabelCustomCssHelp"),value:null==U?void 0:U.CustomCss,onChange:_,slotProps:{input:{className:"textarea-mono"}}}),(0,a.jsx)(u.A,{type:"submit",size:"large",children:w.Ay.translate("Save")})]})})})})};q.displayName="BrandingPage"},51371:function(e,n,t){t.d(n,{u:function(){return a}});var a="/Branding/Splashscreen"},69664:function(e,n,t){var a=t(62540),r=t(12029),i=t(92779),o=t(69856),s=t(90158);t(63696),n.A=function(e){var n=e.isLoading,t=e.alt,l=e.url,c=e.aspectRatio,u=void 0===c?16/9:c,d=e.FallbackIcon,f=void 0===d?r.A:d;return(0,a.jsxs)(o.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",aspectRatio:u,overflow:"hidden"},children:[n&&(0,a.jsx)(s.A,{variant:"rectangular",width:"100%",height:"100%"}),l?(0,a.jsx)("img",{src:l,alt:t,width:"100%"}):(0,a.jsx)(i.A,{sx:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,a.jsx)(f,{sx:{height:"25%",width:"auto"}})})]})}}}]);